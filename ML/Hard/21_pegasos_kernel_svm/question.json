{
    "qid": 21,
    "title": "Pegasos Kernel SVM Implementation",
    "qtext": "# Pegasos Kernel SVM Implementation\n\n## Problem Description\n\nImplement a deterministic version of the Pegasos algorithm to train a kernel Support Vector Machine (SVM) classifier from scratch. The function should accept the following inputs:\n\n- A dataset represented as a 2D NumPy array $X \\in \\mathbb{R}^{m \\times n}$, where each row corresponds to a data sample and each column corresponds to a feature.\n- A label vector $y \\in \\mathbb{R}^m$, where each entry corresponds to the label of the sample and is either $1$ or $-1$.\n- A string indicating the choice of kernel, either `'linear'` or `'rbf'`.\n- A regularization parameter $\\lambda > 0$.\n- The number of iterations to perform, denoted as an integer.\n\nThe Pegasos algorithm in its original form is stochastic, selecting a single random sample at each step. However, this implementation should use all samples in every iteration, effectively making it a batch version of the algorithm.\n\nThe function should perform binary classification and return the model's alpha coefficients and bias term.\n\n## Constraints\n- The dataset $X$ is a NumPy array with dimensions $m \\times n$, where $1 \\leq m, n \\leq 1000$.\n- The label vector $y$ is a NumPy array of length $m$ with elements in $\\{-1, 1\\}$.\n- The kernel parameter is either `'linear'` or `'rbf'`.\n- The regularization parameter $\\lambda$ is a positive float.\n- The number of iterations is a positive integer.\n\n## Example 1\n\n**Input:**\n```python\ndata = np.array([[1, 2], [2, 3], [3, 1], [4, 1]])\nlabels = np.array([1, 1, -1, -1])\nkernel = 'rbf'\nlambda_val = 0.01\niterations = 100\n```\n\n**Output:**\n```python\nalpha = [0.03, 0.02, 0.05, 0.01]\nb = -0.05\n```\n\n**Explanation:** Using the RBF kernel, the Pegasos algorithm iteratively updates the weights based on a sub-gradient descent method, taking into account the non-linear separability of the data induced by the kernel transformation.",
    "inputFormat": "data = np.array([[1, 2], [2, 3], [3, 1], [4, 1]]), labels = np.array([1, 1, -1, -1]), kernel = 'rbf', lambda_val = 0.01, iterations = 100",
    "outputFormat": "alpha = [0.03, 0.02, 0.05, 0.01], b = -0.05",
    "reason": "Using the RBF kernel, the Pegasos algorithm iteratively updates the weights based on a sub-gradient descent method, taking into account the non-linear separability of the data induced by the kernel transformation.",
    "learnAbout": "## Learning: Pegasos Algorithm and Kernel SVM\n\nThe Pegasos (Primal Estimated sub-GrAdient SOlver for SVM) algorithm is an efficient method for solving the optimization problem associated with Support Vector Machines (SVMs). Unlike traditional SVM solvers that work in the dual space, Pegasos operates in the primal space and uses stochastic sub-gradient descent to find the optimal hyperplane. The algorithm's efficiency stems from its ability to handle large datasets due to its linear convergence rate with respect to the number of iterations.\n\nKernel SVMs extend the concept of linear SVMs to non-linear decision boundaries by applying a kernel function, which implicitly maps the input data into a higher-dimensional feature space. Common kernels include the linear kernel, which does not transform the data, and the Radial Basis Function (RBF) kernel, which can model complex, non-linear relationships. The Pegasos algorithm can be adapted to work with kernel functions, allowing it to solve non-linear classification problems efficiently."
}